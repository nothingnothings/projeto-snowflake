











SABEMOS QUE, NO SNOWFLAKE,




MAINLY "PAGAMOS O QUE UTILIZAMOS"...









PORTANTO,



É BEM IMPORTANTE QUE 

MONITOREMOS 


OS RECURSOS GASTOS POR NÓS...
















--> SABEMOS QUE PAGAMOS TANTO PELA STORAGE 
COMO COMPUTE RESOURCES..
.













--. PARA MONITORAR ISSO,

PODEMOS 



USAR A INTERFACE,

PARA VER A
 

 USAGE DA DATA STORAGE 


 E A
  

  USAGE 

  DOS CREDITS 

  PARA 

  OS WAREHOUSES QUE USAMOS...














--> OK... MAS TALVEZ QUEIRAMOS 


ANALISAR ISSO DE FORMA MAIS ESPECÍFICA,




TALVEZ USANDO FERRAMENTAS COMO POWER BI 


E TABLEAU...







E PODEMOS FAZER ISSO, SIM,


PODEMOS 

QUERIAR 


ESSA USAGE DE DATA STORAGE 








E ___ A CONSUMPTION 


DE VIRTUAL WAREHOUSES...









--> PARA ISSO,




TEMOS ALGUMAS HELPFUL QUERIES,

QUE PODEM NOS AJUDAR COM ISSO:







-- Table storage -- 
SELECT * FROM SNOWFLAKE.ACCOUNT_USAGE.TABLE_STORAGE_METRICS;




-- How much is queried in databases 
SELECT * FROM SNOWFLAKE.ACCOUNT_USAGE.QUERY_HISTORY;
SELECT COUNT(*) FROM SNOWFLAKE.ACCOUNT_USAGE.QUERY_HISTORY;





SELECT 
    DATABASE_NAME,
    COUNT(*) AS NUMBER_OF_QUERIES,
    SUM(CREDITS_USED_CLOUD_SERVICES)
FROM SNOWFLAKE.ACCOUNT_USAGE.QUERY_HISTORY
GROUP BY DATABASE_NAME;



-- Usage of credits by warehouse 
SELECT * FROM SNOWFLAKE.ACCOUNT_USAGE.WAREHOUSE_METERING_HISTORY;



-- Usage of credits by warehouses // Grouped by warehouse
SELECT
WAREHOUSE_NAME,
SUM(CREDITS_USED)
FROM "SNOWFLAKE"."ACCOUNT_USAGE"."WAREHOUSE_METERING_HISTORY"
GROUP BY WAREHOUSE_NAME;


-- Usage of credits by warehouses // Grouped by warehouse & day
SELECT
DATE(START_TIME),
WAREHOUSE_NAME,
SUM(CREDITS_USED)
FROM "SNOWFLAKE"."ACCOUNT_USAGE"."WAREHOUSE_METERING_HISTORY"
GROUP BY WAREHOUSE_NAME,DATE(START_TIME);



















--> ok... 




essas queries sao bem úteis 

para termos mais nocao 


sobre quantos recursos gastamos 


com a storage e compute resources..

















--> SE DROPPAMOS 1 PERMANENT TABLE,

PELO MENOS TEMOS 


O TIME TRAVEL PERIOD,

E O FAILSAFE 

PERIOD DE 7 DIAS, TAMBÉM...










