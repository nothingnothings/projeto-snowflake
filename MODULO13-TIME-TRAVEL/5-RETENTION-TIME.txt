






TIME TRAVEL - RETENTION TIME...




----------------------




agora falaremos sobre o retention time do snowflake...













STANDARD --> TIME TRAVEL DE ATÉ 1 DIA...







ENTERPRISE -> TIME TRAVEL DE ATÉ 90 DIAS 








BUSINESS CRITICAL -- TIME TRAVEL DE ATÉ 90 DIAS...







VIRTUAL PRIVATE -> TIME TRAVEL DE ATÉ 90 DIAS.
















-----> ISSO É O QUANTO PODEMOS NAVEGAR,

ATÉ O PASSADO,

NO SNOWFLAKE...







TUDO DEPENDE 

DA EDITION QUE VC ESTÁ USANDO, CLARO...


















OK.... MAS É CLARO QUE ISSO NAO QUER DIZER QUE PODEMOS,

POR DEFAULT,


PARA TODOS OS OBJECTS,






FAZER __ TRAVEL __ 


BACK 

DE 90 DIAS....
















--> ISSO PQ __ TEMOS ALGO CHAMADO 




DE 

"""RETENTION PERIOD""""...












O RETENTION PERIOD É BASICAMENTE 

1 

PROPRIEDADE 

DE NOSSOS OBJECTS,




COMO POR EXEMPLO TABLES...






----------------------------










O RETENTION TIME ESPECIFICA 





""ATÉ QUANTO TEMPO PODEMOS TRAVEL BACK,


PARA ESSE OBJECT ESPECÍFICO""...









--> o value default 

É USUALMENTE 

1...










--> QUER DIZER QUE 


SE 1 TABLE TIVER 


ESSE RETENTION PERIOD,


ESSA PROPRIEDADE,



DEFINIDA COMO "1",





ISSO QUER DIZER QUE PODEMOS 




TRAVEL BACK 


ATÉ 24 HORAS,

PARA ESSA TABLE...


















--> MAS PARA O PLANO ENTERPRISE E TODO O RESTO,


RESTO QUE NAO É O STANDARD,





PODEMOS __ MUDAR_ _ ESSE VALUE DO RETENTION 

PERIOD,

E DEIXAR COMO 




__ ATÉ __ 90 DIAS...











--> É ISSO QUE DEVEMOS SABER... NAO É 

TAO COMPLICADO,

E É ALGO QUE DEVEMOS TER EM MENTE...













--> VEREMOS COMO PODEMOS USAR E ALTERAR 

ESSE 

RETENTION PERIOD,

NAS NOSSAS TABLES...












-- PARA VER O RETENTION TIME PERIOD (quanto tempo podemos VOLTAR NO TEMPO, em nossos objects) DE NOSSOS OBJECTS SNOWFLAKE, 
-- PODEMOS USAR O COMANDO "SHOW xxxx"....

-- exemplo --> show tables:




-- show properties like retention_time...
SHOW TABLES LIKE '%CUSTOMERS%';

USE DATABASE OUR_FIRST_DB;
SHOW TABLES; -- column - "retention_time"


ALTER TABLE OUR_FIRST_DB.PUBLIC.CUSTOMERS
SET DATA_RETENTION_TIME_IN_DAYS=1; -- 1 é o DEFAULT.















QUER DIZER QUE EM TODAS NOSSAS TABLES,

POR DEFAULT,
PODEMOS RETROCEDER 

ATÉ 1 DIA....








QUAISQUER CHANGES QUE ACONTECEREM NAS 


ÚLTIMAS 24 HORAS PODEM SER REVERTIDAS...












--> MAS COMO PODEMOS __ ALTERAR ESSE VALUE?









-- HÁ 2 MANEIRAS...







SAO ELAS:














-- 1a MANEIRA) SE UMA TABLE JÁ EXISTE...




-- nesse caso, DEFINIMOS A PROPRIEDADE 
-- DATA_RETENTION_TIME_IN_DAYS como sendo 1 diferente value.....



ALTER TABLE OUR_FIRST_DB.PUBLIC.CUSTOMERS
SET DATA_RETENTION_TIME_IN_DAYS=2; -- 1 é o DEFAULT.




-- 2a MANEIRA) PODEMOS CRIAR 1 TABLE JÁ COM ESSA SETTING DEFINIDA:
CREATE OR REPLACE TABLE OUR_FIRST_DB.public.retention_example (
ID INT,
FIRST_NAME STRING,
LAST_NAME STRING,
EMAIL STRING,
GENDER STRING, 
JOB STRING,
PHONE STRING)
DATA_RETENTION_TIME_IN_DAYS=3;



-- we see our retention time....
SHOW TABLES LIKE '%EX%';



----------------------











OK.... 


MAS SE ALTERARMOS ESSA PROPRIEDADE 


A 1


VALUE DE 0,

ISSO 



VAI BASICAMENTE DESABILITAR 
ESSA FEATURE DE TIME TRAVEL,

NAO PODEREMOS USAR __ AT ALL_.....













EX:





ALTER TABLE OUR_FIRST_DB.PUBLIC.retention_example
SET DATA_RETENTION_TIME_IN_DAYS=0; //disabled time travel feature





DROP TABLE OUR_FIRST_DB.PUBLIC.retention_example;
UNDROP TABLE OUR_FIRST_DB.PUBLIC.RETENTION_EXAMPLE; -- this wont be possible (because we set data_retention_time_in-days to 0)

















--> COMO "UNDROP" FAZ PARTE DO TIME TRAVEL,



SE DEFINIMOS ESSA PROPERTY DE 

"DATA_RETENTION_TIME_IN_DAYS"

COMO O,


NAO PODEMOS MAIS O UTILIZAR...









--> OK... PODEMOS ALTERAR ESSA PROPERTY, SIM...


MAS QUAL É A VANTAGEM DE DEIXÁ-LA COMO 1?







pq nao deixaríamos como 90?






A RAZAO PARA ISSO É QUE 

___eXISTE 1 CUSTO __ INDIRETO ENVOLVIDO...










--> QUER DIZER QUE GASTAMOS MAIS STORAGE,

COM ESSA FEATURE... PQ 

ESSE TIME-TRAVEL PRECISA SER ARMAZENADO TAMBÉM,

E TEMOS QUE 


PAGAR POR ESSA STORAGE...








-> NA PROXIMA AULA, VEREMOS QUAIS SAO OS CUSTOS 

DO TIME TRAVEL....